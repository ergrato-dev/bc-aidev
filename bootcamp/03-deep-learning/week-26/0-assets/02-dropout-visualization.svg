<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 480">
  <defs>
    <style>
      .bg { fill: #1a1a2e; }
      .title { fill: #ffffff; font-family: system-ui, -apple-system, sans-serif; font-size: 24px; font-weight: bold; }
      .subtitle { fill: #a0a0a0; font-family: system-ui, -apple-system, sans-serif; font-size: 14px; }
      .label { fill: #ffffff; font-family: system-ui, -apple-system, sans-serif; font-size: 14px; font-weight: bold; }
      .label-small { fill: #cccccc; font-family: system-ui, -apple-system, sans-serif; font-size: 12px; }
      .neuron-active { fill: #4ecdc4; stroke: #2d8a84; stroke-width: 2; }
      .neuron-dropped { fill: #3d3d5c; stroke: #ff6b6b; stroke-width: 2; stroke-dasharray: 4,2; }
      .connection { stroke: #4a4a6a; stroke-width: 1.5; }
      .connection-active { stroke: #4ecdc4; stroke-width: 2; }
      .connection-dropped { stroke: #ff6b6b; stroke-width: 1; stroke-dasharray: 3,3; opacity: 0.4; }
      .box { fill: #2d2d44; stroke: #4a4a6a; stroke-width: 2; rx: 10; }
      .arrow { fill: #888888; }
    </style>
  </defs>
  
  <!-- Background -->
  <rect class="bg" width="900" height="480"/>
  
  <!-- Title -->
  <text class="title" x="450" y="35" text-anchor="middle">Dropout: Regularización por Eliminación</text>
  <text class="subtitle" x="450" y="57" text-anchor="middle">Apaga neuronas aleatoriamente durante entrenamiento (p = probabilidad de dropout)</text>
  
  <!-- Left Network: Sin Dropout -->
  <g transform="translate(80, 90)">
    <rect class="box" x="-20" y="-20" width="280" height="320"/>
    <text class="label" x="120" y="5" text-anchor="middle">Sin Dropout</text>
    
    <!-- Input Layer -->
    <circle class="neuron-active" cx="40" cy="70" r="18"/>
    <circle class="neuron-active" cx="40" cy="130" r="18"/>
    <circle class="neuron-active" cx="40" cy="190" r="18"/>
    <circle class="neuron-active" cx="40" cy="250" r="18"/>
    
    <!-- Hidden Layer -->
    <circle class="neuron-active" cx="120" cy="85" r="18"/>
    <circle class="neuron-active" cx="120" cy="145" r="18"/>
    <circle class="neuron-active" cx="120" cy="205" r="18"/>
    <circle class="neuron-active" cx="120" cy="265" r="18"/>
    
    <!-- Output Layer -->
    <circle class="neuron-active" cx="200" cy="130" r="18"/>
    <circle class="neuron-active" cx="200" cy="190" r="18"/>
    
    <!-- Connections (all active) -->
    <!-- Input to Hidden -->
    <g class="connection-active" opacity="0.6">
      <line x1="58" y1="70" x2="102" y2="85"/>
      <line x1="58" y1="70" x2="102" y2="145"/>
      <line x1="58" y1="130" x2="102" y2="85"/>
      <line x1="58" y1="130" x2="102" y2="145"/>
      <line x1="58" y1="130" x2="102" y2="205"/>
      <line x1="58" y1="190" x2="102" y2="145"/>
      <line x1="58" y1="190" x2="102" y2="205"/>
      <line x1="58" y1="190" x2="102" y2="265"/>
      <line x1="58" y1="250" x2="102" y2="205"/>
      <line x1="58" y1="250" x2="102" y2="265"/>
    </g>
    
    <!-- Hidden to Output -->
    <g class="connection-active" opacity="0.6">
      <line x1="138" y1="85" x2="182" y2="130"/>
      <line x1="138" y1="145" x2="182" y2="130"/>
      <line x1="138" y1="145" x2="182" y2="190"/>
      <line x1="138" y1="205" x2="182" y2="130"/>
      <line x1="138" y1="205" x2="182" y2="190"/>
      <line x1="138" y1="265" x2="182" y2="190"/>
    </g>
    
    <text class="label-small" x="120" y="310" text-anchor="middle">Todas las neuronas activas</text>
  </g>
  
  <!-- Arrow -->
  <g transform="translate(380, 240)">
    <polygon class="arrow" points="0,-15 30,0 0,15"/>
    <text class="label-small" x="15" y="35" text-anchor="middle">p=0.5</text>
  </g>
  
  <!-- Right Network: Con Dropout -->
  <g transform="translate(450, 90)">
    <rect class="box" x="-20" y="-20" width="280" height="320"/>
    <text class="label" x="120" y="5" text-anchor="middle">Con Dropout (Training)</text>
    
    <!-- Input Layer -->
    <circle class="neuron-active" cx="40" cy="70" r="18"/>
    <circle class="neuron-dropped" cx="40" cy="130" r="18"/>
    <text x="40" y="135" text-anchor="middle" fill="#ff6b6b" font-size="16">✕</text>
    <circle class="neuron-active" cx="40" cy="190" r="18"/>
    <circle class="neuron-active" cx="40" cy="250" r="18"/>
    
    <!-- Hidden Layer -->
    <circle class="neuron-active" cx="120" cy="85" r="18"/>
    <circle class="neuron-dropped" cx="120" cy="145" r="18"/>
    <text x="120" y="150" text-anchor="middle" fill="#ff6b6b" font-size="16">✕</text>
    <circle class="neuron-active" cx="120" cy="205" r="18"/>
    <circle class="neuron-dropped" cx="120" cy="265" r="18"/>
    <text x="120" y="270" text-anchor="middle" fill="#ff6b6b" font-size="16">✕</text>
    
    <!-- Output Layer -->
    <circle class="neuron-active" cx="200" cy="130" r="18"/>
    <circle class="neuron-active" cx="200" cy="190" r="18"/>
    
    <!-- Active Connections -->
    <g class="connection-active" opacity="0.7">
      <line x1="58" y1="70" x2="102" y2="85"/>
      <line x1="58" y1="190" x2="102" y2="205"/>
      <line x1="58" y1="250" x2="102" y2="205"/>
      <line x1="138" y1="85" x2="182" y2="130"/>
      <line x1="138" y1="205" x2="182" y2="130"/>
      <line x1="138" y1="205" x2="182" y2="190"/>
    </g>
    
    <!-- Dropped Connections -->
    <g class="connection-dropped">
      <line x1="58" y1="70" x2="102" y2="145"/>
      <line x1="58" y1="130" x2="102" y2="85"/>
      <line x1="58" y1="190" x2="102" y2="265"/>
      <line x1="138" y1="145" x2="182" y2="130"/>
      <line x1="138" y1="265" x2="182" y2="190"/>
    </g>
    
    <text class="label-small" x="120" y="310" text-anchor="middle">~50% neuronas apagadas</text>
  </g>
  
  <!-- Info Panel -->
  <g transform="translate(760, 90)">
    <rect class="box" x="0" y="0" width="120" height="240"/>
    <text class="label" x="60" y="30" text-anchor="middle" font-size="12">Valores de p</text>
    
    <circle class="neuron-active" cx="30" cy="65" r="10"/>
    <text class="label-small" x="50" y="70">FC: 0.5</text>
    
    <circle class="neuron-active" cx="30" cy="105" r="10"/>
    <text class="label-small" x="50" y="110">Conv: 0.25</text>
    
    <circle class="neuron-active" cx="30" cy="145" r="10"/>
    <text class="label-small" x="50" y="150">Embed: 0.1</text>
    
    <line x1="15" y1="175" x2="105" y2="175" stroke="#4a4a6a" stroke-width="1"/>
    
    <text class="label-small" x="60" y="200" text-anchor="middle">Training:</text>
    <text class="label-small" x="60" y="218" text-anchor="middle" fill="#4ecdc4">model.train()</text>
  </g>
  
  <!-- Bottom Note -->
  <text class="subtitle" x="450" y="445" text-anchor="middle">Inverted Dropout: salida × 1/(1-p) para mantener valor esperado constante</text>
  <text class="subtitle" x="450" y="465" text-anchor="middle">En inferencia (model.eval()): todas las neuronas activas, sin escalado</text>
</svg>